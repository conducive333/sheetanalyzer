#!/bin/bash

JAVA_CONFIG=-Xss4m
MAVEN_HOME=~/.m2
SHEETANALYZER_HOME=/home/sheetanalyzer

TEST_HOME=`pwd`
REPORT_HOME=$TEST_HOME/report
TEST_MAIN=org.dataspread.sheetanalyzer.mainTest.TestSheetAnalyzer

max_mem=120G
java_opt="-Xmx${max_mem} -Xms${max_mem} -XX:+UseParallelGC -XX:+UseParallelOldGC"


if [ "$#" -ne 2 ]; then
	echo "Need two parameters: xls(s) folder or a xls(x) file + output folder"
    exit
fi

CLASSPATH=$SHEETANALYZER_HOME/target/classes:$MAVEN_HOME/repository/com/github/davidmoten/rtree/0.8.6/rtree-0.8.6.jar:$MAVEN_HOME/repository/com/github/davidmoten/guava-mini/0.1.1/guava-mini-0.1.1.jar:$MAVEN_HOME/repository/io/reactivex/rxjava/1.3.8/rxjava-1.3.8.jar:$MAVEN_HOME/repository/com/google/guava/guava/30.0-jre/guava-30.0-jre.jar:$MAVEN_HOME/repository/com/google/guava/failureaccess/1.0.1/failureaccess-1.0.1.jar:$MAVEN_HOME/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar:$MAVEN_HOME/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar:$MAVEN_HOME/repository/org/checkerframework/checker-qual/3.5.0/checker-qual-3.5.0.jar:$MAVEN_HOME/repository/com/google/errorprone/error_prone_annotations/2.3.4/error_prone_annotations-2.3.4.jar:$MAVEN_HOME/repository/com/google/j2objc/j2objc-annotations/1.3/j2objc-annotations-1.3.jar:$MAVEN_HOME/repository/org/apache/poi/poi/5.0.0/poi-5.0.0.jar:$MAVEN_HOME/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:$MAVEN_HOME/repository/org/slf4j/jcl-over-slf4j/1.7.30/jcl-over-slf4j-1.7.30.jar:$MAVEN_HOME/repository/commons-codec/commons-codec/1.15/commons-codec-1.15.jar:$MAVEN_HOME/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar:$MAVEN_HOME/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar:$MAVEN_HOME/repository/com/zaxxer/SparseBitSet/1.2/SparseBitSet-1.2.jar:$MAVEN_HOME/repository/org/apache/poi/poi-ooxml/5.0.0/poi-ooxml-5.0.0.jar:$MAVEN_HOME/repository/org/apache/poi/poi-ooxml-lite/5.0.0/poi-ooxml-lite-5.0.0.jar:$MAVEN_HOME/repository/org/apache/xmlbeans/xmlbeans/4.0.0/xmlbeans-4.0.0.jar:$MAVEN_HOME/repository/org/apache/commons/commons-compress/1.20/commons-compress-1.20.jar:$MAVEN_HOME/repository/com/github/virtuald/curvesapi/1.06/curvesapi-1.06.jar:$MAVEN_HOME/repository/org/bouncycastle/bcpkix-jdk15on/1.68/bcpkix-jdk15on-1.68.jar:$MAVEN_HOME/repository/org/bouncycastle/bcprov-jdk15on/1.68/bcprov-jdk15on-1.68.jar:$MAVEN_HOME/repository/org/apache/santuario/xmlsec/2.2.1/xmlsec-2.2.1.jar:$MAVEN_HOME/repository/com/fasterxml/woodstox/woodstox-core/5.2.1/woodstox-core-5.2.1.jar:$MAVEN_HOME/repository/org/codehaus/woodstox/stax2-api/4.2/stax2-api-4.2.jar:$MAVEN_HOME/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:$MAVEN_HOME/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-all/1.13/batik-all-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-anim/1.13/batik-anim-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-shared-resources/1.13/batik-shared-resources-1.13.jar:$MAVEN_HOME/repository/xml-apis/xml-apis-ext/1.3.04/xml-apis-ext-1.3.04.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-awt-util/1.13/batik-awt-util-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/xmlgraphics-commons/2.4/xmlgraphics-commons-2.4.jar:$MAVEN_HOME/repository/commons-io/commons-io/1.3.1/commons-io-1.3.1.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-bridge/1.13/batik-bridge-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-codec/1.13/batik-codec-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-constants/1.13/batik-constants-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-css/1.13/batik-css-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-dom/1.13/batik-dom-1.13.jar:$MAVEN_HOME/repository/xalan/xalan/2.7.2/xalan-2.7.2.jar:$MAVEN_HOME/repository/xalan/serializer/2.7.2/serializer-2.7.2.jar:$MAVEN_HOME/repository/xml-apis/xml-apis/1.4.01/xml-apis-1.4.01.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-ext/1.13/batik-ext-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-extension/1.13/batik-extension-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-gui-util/1.13/batik-gui-util-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-gvt/1.13/batik-gvt-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-i18n/1.13/batik-i18n-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-parser/1.13/batik-parser-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-rasterizer-ext/1.13/batik-rasterizer-ext-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-rasterizer/1.13/batik-rasterizer-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-script/1.13/batik-script-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-slideshow/1.13/batik-slideshow-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-squiggle-ext/1.13/batik-squiggle-ext-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-squiggle/1.13/batik-squiggle-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-svg-dom/1.13/batik-svg-dom-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-svgbrowser/1.13/batik-svgbrowser-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-svggen/1.13/batik-svggen-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-svgpp/1.13/batik-svgpp-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-svgrasterizer/1.13/batik-svgrasterizer-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-swing/1.13/batik-swing-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-transcoder/1.13/batik-transcoder-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-util/1.13/batik-util-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-ttf2svg/1.13/batik-ttf2svg-1.13.jar:$MAVEN_HOME/repository/org/apache/xmlgraphics/batik-xml/1.13/batik-xml-1.13.jar:$MAVEN_HOME/repository/de/rototor/pdfbox/graphics2d/0.30/graphics2d-0.30.jar:$MAVEN_HOME/repository/org/apache/pdfbox/pdfbox/2.0.22/pdfbox-2.0.22.jar:$MAVEN_HOME/repository/org/apache/pdfbox/fontbox/2.0.22/fontbox-2.0.22.jar

java $JAVA_CONFIG \
	-classpath $CLASSPATH\
	$java_opt \
	$TEST_MAIN \
	"$1" \
	$2

